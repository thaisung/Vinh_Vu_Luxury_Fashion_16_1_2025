{% extends './base.html' %}
{% block content %}
<div class="flex-1 flex-col w-full h-full" style="width: calc(100% - 250px);">
    <header class="z-10 py-4 bg-white shadow-md dark:bg-gray-800 flex  px-[10px] justify-start md:justify-center items-start md:items-center">
        <button class="open_menu_website p-1 mr-5 -ml-1 rounded-md md:hidden focus:outline-none focus:shadow-outline-green"
          @click="toggleSideMenu" aria-label="Menu">
          <svg class="w-6 h-6" aria-hidden="true" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd"
              d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
              clip-rule="evenodd"></path>
          </svg>
        </button>
        <!-- Search input -->
        <div class="flex flex-row md:flex-col justify-center items-start md:items-center  gap-2 w-full overflow-x-auto">
          <div class="flex flex-col md:flex-row  justify-start h-full   gap-3 ">
            <button
              class="open_form_create w-full flex gap-2 shadow-md items-center justify-center self-start px-4 py-2 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-green-600 border border-transparent rounded-lg active:bg-green-600 hover:bg-green-700 focus:outline-none focus:shadow-outline-green">
              <svg class="fill-white w-[20px]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="feather feather-plus">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
              <span class="whitespace-nowrap hidden md:block">Tạo khách hàng mới</span>
            </button>
            <!-- <button
              class="open_form_upload_file flex gap-2 shadow-md items-center justify-between self-start px-4 py-2 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-green-600 border border-transparent rounded-lg active:bg-green-600 hover:bg-green-700 focus:outline-none focus:shadow-outline-green">
              <svg class="fill-white w-[20px]" id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>cloud, upload, storage, memory, data</title><path d="M20.57,9.43A8,8,0,0,0,5.26,10,5,5,0,1,0,5,20h5V18H5a3,3,0,0,1,0-6,3.1,3.1,0,0,1,.79.12l1.12.31.14-1.15a6,6,0,0,1,11.74-.82l.15.54.54.16A3.46,3.46,0,0,1,22,14.5,3.5,3.5,0,0,1,18.5,18H16v2h2.5A5.48,5.48,0,0,0,20.57,9.43Z"></path><polygon points="16.71 15.29 13 11.59 9.29 15.29 10.71 16.71 12 15.41 12 20 14 20 14 15.41 15.29 16.71 16.71 15.29"></polygon></svg>
              <span class="whitespace-nowrap hidden md:block">Nhập file khách hàng mới</span>
            </button> -->
            <!-- <a href="{% url 'export_lead' %}"
              class="flex gap-2 w-full shadow-md items-center justify-center self-start px-4 py-2 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-green-700 border border-transparent rounded-lg active:bg-green-600 hover:bg-green-800 focus:outline-none focus:shadow-outline-green">
              <svg class="fill-white w-[20px]" id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>cloud, download, storage, memory, data</title><path d="M20.57,9.43A8,8,0,0,0,5.26,10,5,5,0,1,0,5,20h5V18H5a3,3,0,0,1,0-6,3.1,3.1,0,0,1,.79.12l1.12.31.14-1.15a6,6,0,0,1,11.74-.82l.15.54.54.16A3.46,3.46,0,0,1,22,14.5,3.5,3.5,0,0,1,18.5,18H16v2h2.5A5.48,5.48,0,0,0,20.57,9.43Z"></path><polygon points="12 11 12 15.59 10.71 14.29 9.29 15.71 13 19.41 16.71 15.71 15.29 14.29 14 15.59 14 11 12 11"></polygon></svg>
              <span class="whitespace-nowrap hidden md:block">Xuất file khách hàng</span>
            </a> -->
          </div>
          <form class="flex flex-col  justify-center items-center grow md:grow-0  gap-3">
            <div class="flex  relative items-center w-full md:w-[300px]">
              <input placeholder="Tìm kiếm khách hàng" name="s" value="{{s}}"
                class="block pr-[30px] w-full bg-stone-100 text-sm text-stone-800 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md " />
              <button type="submit" class="absolute right-0 cursor-pointer">
                <svg class="w-[30px]" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                  <title>icon 111 search</title>
                  <desc>Created with Sketch.</desc>
                  <defs></defs>
                  <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">
                    <g id="icon-111-search" sketch:type="MSArtboardGroup" fill="#000000">
                      <path
                        d="M19.4271164,21.4271164 C18.0372495,22.4174803 16.3366522,23 14.5,23 C9.80557939,23 6,19.1944206 6,14.5 C6,9.80557939 9.80557939,6 14.5,6 C19.1944206,6 23,9.80557939 23,14.5 C23,16.3366522 22.4174803,18.0372495 21.4271164,19.4271164 L27.0119176,25.0119176 C27.5621186,25.5621186 27.5575313,26.4424687 27.0117185,26.9882815 L26.9882815,27.0117185 C26.4438648,27.5561352 25.5576204,27.5576204 25.0119176,27.0119176 L19.4271164,21.4271164 L19.4271164,21.4271164 Z M14.5,21 C18.0898511,21 21,18.0898511 21,14.5 C21,10.9101489 18.0898511,8 14.5,8 C10.9101489,8 8,10.9101489 8,14.5 C8,18.0898511 10.9101489,21 14.5,21 L14.5,21 Z"
                        id="search" sketch:type="MSShapeGroup"></path>
                    </g>
                  </g>
                </svg>
              </button>
            </div>
            <div class="flex flex-col lg:flex-row gap-3 w-full">
              <div class="flex gap-2 w-full">
                <select name="f" onchange="this.form.submit()" value="{{f}}"
                class="bg-stone-100 text-sm text-stone-800 w-full md:w-[250px]  focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md">
                <option value="" class="bg-stone-100">--- Danh mục sản phẩm ---</option>
                {% for i in list_campaign %}
                <option value="{{i.id}}" {% if f == i.id %}selected{% endif %} class="bg-stone-100">{{i.Name}}</option>
                {% endfor %}
              </select>
              <select name="st" onchange="this.form.submit()" value="{{st}}"
                class="bg-stone-100 text-sm text-stone-800 w-full md:w-[250px]  focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md">
                <option value="" class="bg-stone-100">--- Trạng thái khách hàng ---</option>
                <option value="Chưa tư vấn" {% if st == 'Chưa tư vấn' %}selected{% endif %} class="bg-stone-100">Chưa tư vấn</option>
                <option value="Đã tư vấn" {% if st == 'Đã tư vấn' %}selected{% endif %} class="bg-stone-100">Đã tư vấn</option>
                <option value="Gửi thông tin" {% if st == 'Gửi thông tin' %}selected{% endif %} class="bg-stone-100">Gửi thông tin</option>
                <option value="Đã xem dự án" {% if st == 'Đã xem dự án' %}selected{% endif %} class="bg-stone-100">Đã xem dự án</option>
                <option value="KH không tiềm năng" {% if st == 'KH không tiềm năng' %}selected{% endif %} class="bg-stone-100">KH không tiềm năng</option>
                <option value="KH Đã booking" {% if st == 'KH Đã booking' %}selected{% endif %} class="bg-stone-100">KH Đã booking</option>
                <option value="KH đã xem nhà mẫu" {% if st == 'KH đã xem nhà mẫu' %}selected{% endif %} class="bg-stone-100">KH đã xem nhà mẫu</option>
                <option value="KH tiềm năng" {% if st == 'KH tiềm năng' %}selected{% endif %} class="bg-stone-100">KH tiềm năng</option>
                <option value="KH Đã mua" {% if st == 'KH Đã mua' %}selected{% endif %} class="bg-stone-100">KH Đã mua</option>
              </select>
              </div>
            <div class="flex gap-2">
              <select name="f1" onchange="this.form.submit()" value="{{f1}}"
              class="bg-stone-100 text-sm text-stone-800 w-full md:w-[250px]  focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md">
              <option value="" class="bg-stone-100">--- Báo cáo ---</option>
              <option value="0" {% if f1 == 0 %}selected{% endif %} class="bg-stone-100">Chưa báo cáo</option>
              <option value="1" {% if f1 == 1 %}selected{% endif %} class="bg-stone-100">Đã báo cáo</option>
              </select>
              <!-- <select name="f2" onchange="this.form.submit()" value="{{f2}}"
                class="bg-stone-100 text-sm text-stone-800 w-full md:w-[250px]  focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md">
                <option value="" class="bg-stone-100">--- Ghi chú lịch sử CSKH ---</option>
                <option value="0" {% if f2 == 0 %}selected{% endif %} class="bg-stone-100">Chưa ghi chú</option>
                <option value="1" {% if f2 == 1 %}selected{% endif %} class="bg-stone-100">Đã ghi chú</option>
              </select> -->
            </div>
            </div>
          </form>
        </div>
    </header>
    <main class="relative flex-1 flex-col gap-2  p-[10px]  bg-stone-100 ">
        {% if request.user.is_staff %}
        <h1 class="text-[18px] font-bold text-stone-800">Danh sách khách hàng</h1>
        <div class="w-full mb-8  rounded-lg shadow-xs flex-1">
            <div id="table-container" class="content draggableDiv w-full max-w-none overflow-x-auto flex-1">
                <table class="min-w-full table-auto whitespace-nowrap">
                    <thead>
                        <tr
                            class="text-xs font-semibold tracking-wide text-left text-gray-500 uppercase border-b dark:border-gray-700 bg-stone-200 dark:text-gray-400 dark:bg-gray-800">
                            <th class="px-4 py-3">Khách hàng</th>
                            <th class="px-4 py-3">Số điện thoại</th>
                            <th class="px-4 py-3">Tình trạng</th>
                            <th class="px-4 py-3">Ghi chú</th>
                            <th class="px-4 py-3">Nguồn</th>
                            <th class="px-4 py-3">Chiến dịch</th>
                            <th class="px-4 py-3">Nhu cầu</th>
                            <th class="px-4 py-3">Sản phẩm</th>
                            <th class="px-4 py-3">Khu vực</th>
                            <th class="px-4 py-3">Trạng thái</th>
                            <th class="px-4 py-3">Xem nội dung</th>
                            <th class="px-4 py-3">Chức năng</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y dark:divide-gray-700 dark:bg-gray-800">
                        {% for i in list_lead %}
                        <tr class="text-gray-700 dark:text-gray-400 h-full">
                            <td 
                                data-id="{{i.id}}" 
                                data-name="{{i.Name}}"
                                data-phone-number="{{i.Phone_number}}"
                                data-area="{{i.Area}}"
                                data-product="{{i.Product}}"
                                data-demand="{{i.Demand}}"
                                data-status="{{i.Status}}"
                                data-note="{{i.Note}}"
                                data-belong-campaign-name="{{i.Belong_Campaign.Name}}"
                                data-belong-campaign-id="{{i.Belong_Campaign.id}}"
                                data-belong-user-username="{{i.Belong_User.username}}"
                                data-belong-user-id="{{i.Belong_User.id}}"
                                class="open_form_update  group  h-full font-medium  cursor-pointer hover:text-green-600 px-4 py-3 text-sm text whitespace-nowrap">
                                <span class="inline-block align-middle hover:underline">{{i.Name}}</span>
                                <svg class="hover:text-green-600 w-[20px] fill-stone-800 inline-block align-middle"  viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                                    <!-- Generator: Sketch 3.0.3 (7891) - http://www.bohemiancoding.com/sketch -->
                                    <title>icon 135 pen angled</title>
                                    <desc>Created with Sketch.</desc>
                                    <defs></defs>
                                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">
                                        <g id="icon-135-pen-angled" sketch:type="MSArtboardGroup" class=" group-hover:fill-green-600 fill-stone-800">
                                            <path d="M23.1464466,12.0278086 L11.8535534,23.3207019 L11.8535534,23.3207019 L7.85355339,19.3207019 L19.1464466,8.02780864 L23.1464466,12.0278086 L23.1464466,12.0278086 Z M23.8535534,11.3207018 L25.5801067,9.59414849 C26.3642921,8.8099631 26.3661881,7.54044334 25.5897496,6.76400487 L24.4102504,5.58450561 C23.6313906,4.80564584 22.372781,4.80147421 21.5801067,5.59414851 L19.8535534,7.32070186 L23.8535534,11.3207018 L23.8535534,11.3207018 Z M11.1464466,24.0278086 L11,24.1742552 L6,25.1742552 L7,20.1742552 L7.14644661,20.0278086 L11.1464466,24.0278086 L11.1464466,24.0278086 Z" id="pen-angled" sketch:type="MSShapeGroup"></path>
                                        </g>
                                    </g>
                                </svg>
                            </td>
                            <td class="px-4 py-3 text-sm hover:underline whitespace-nowrap">
                                <a href="tel:{{i.Phone_number}}">{{i.Phone_number}}</a>
                            </td>
                            <td class="px-4 py-3 text-sm whitespace-nowrap">
                                <form method="post" action={% url 'lead_update_Status_lead_page_staff' %}>
                                    {% csrf_token %}
                                    <input type="hidden" name="id_lead_update_st" value="{{i.id}}"/>
                                    <select name="st" onchange="this.form.submit()" value="{{i.Status_lead}}"
                                    class="font-medium {% if i.Status_lead == 'Chưa tư vấn' %}bg-stone-100
                                    {% elif i.Status_lead == 'Đã tư vấn' %}bg-[#a6f0fa]
                                    {% elif i.Status_lead == 'Gửi thông tin' %}bg-[#d2ff9e]
                                    {% elif i.Status_lead == 'Đã xem dự án' %}bg-[#ffac92]
                                    {% elif i.Status_lead == 'KH không tiềm năng' %}bg-[#bcbcbc]
                                    {% elif i.Status_lead == 'KH Đã booking' %}bg-[#FF9800]
                                    {% elif i.Status_lead == 'KH đã xem nhà mẫu' %}bg-[#03A9F4]
                                    {% elif i.Status_lead == 'KH tiềm năng' %}bg-[#ffee5d]
                                    {% elif i.Status_lead == 'KH Đã mua' %}bg-[#ff6262]
                                    {% endif %} text-sm text-stone-800 w-full md:w-[200px]  focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md">
                                        <option value="" class="bg-stone-100">--- Trạng thái khách hàng ---</option>
                                        <option value="Chưa tư vấn" {% if i.Status_lead == 'Chưa tư vấn' %}selected{% endif %} class="bg-stone-100">Chưa tư vấn</option>
                                        <option value="Đã tư vấn" {% if i.Status_lead == 'Đã tư vấn' %}selected{% endif %} class="bg-stone-100">Đã tư vấn</option>
                                        <option value="Gửi thông tin" {% if i.Status_lead == 'Gửi thông tin' %}selected{% endif %} class="bg-stone-100">Gửi thông tin</option>
                                        <option value="Đã xem dự án" {% if i.Status_lead == 'Đã xem dự án' %}selected{% endif %} class="bg-stone-100">Đã xem dự án</option>
                                        <option value="KH không tiềm năng" {% if i.Status_lead == 'KH không tiềm năng' %}selected{% endif %} class="bg-stone-100">KH không tiềm năng</option>
                                        <option value="KH Đã booking" {% if i.Status_lead == 'KH Đã booking' %}selected{% endif %} class="bg-stone-100">KH Đã booking</option>
                                        <option value="KH đã xem nhà mẫu" {% if i.Status_lead == 'KH đã xem nhà mẫu' %}selected{% endif %} class="bg-stone-100">KH đã xem nhà mẫu</option>
                                        <option value="KH tiềm năng" {% if i.Status_lead == 'KH tiềm năng' %}selected{% endif %} class="bg-stone-100">KH tiềm năng</option>
                                        <option value="KH Đã mua" {% if i.Status_lead == 'KH Đã mua' %}selected{% endif %} class="bg-stone-100">KH Đã mua</option>
                                    </select>
                                </form>
                            </td>
                            <td class="px-4 py-3 text-sm whitespace-nowrap">
                                {% if i.Note %}{{ i.Note|linebreaksbr }}{% endif %}
                            </td>
                            <td class="px-4 py-3 text-sm whitespace-nowrap">
                                {% if i.Source %}{{i.Source}}{% endif %}
                            </td>
                            <td class="px-4 py-3 text-sm max-w-[200px] overflow-x-auto whitespace-nowrap">
                                {{ i.Belong_Campaign.Name }}
                            </td>
                            <td class="px-4 py-3 text-sm whitespace-nowrap">
                                {{i.Demand}}
                            </td>
                            <td class="px-4 py-3 text-sm whitespace-nowrap">
                                {{i.Product}}
                            </td>
                            <td class="px-4 py-3 text-sm whitespace-nowrap">
                                {{i.Area}}
                            </td>
                            <td class="px-4 py-3 text-sm whitespace-nowrap">
                                {{i.Status}}
                            </td>
                            <td class="px-4 py-3 text-sm whitespace-nowrap">
                                <div class="flex flex-col justify-center ">
                                    <span data-id="{{i.id}}" data-name="{{i.Name}}" class="open_view_report text-green-500 cursor-pointer hover:underline whitespace-nowrap">Xem báo cáo ({{i.list_report.all.count|default:'0'}})</span>
                                    {% comment %} <span data-id="{{i.id}}" data-name="{{i.Name}}" class="open_view_history text-stone-500 cursor-pointer hover:underline whitespace-nowrap">Xem lịch sử ({{i.list_history.all.count|default:'0'}})</span> {% endcomment %}
                                </div>
                            </td>
                            <td>
                                <div class="flex px-3 py-3 text-sm justify-center items-center grow">
                                    {% comment %} <a title="Cập nhật"
                                    data-id="{{i.id}}" 
                                    data-name="{{i.Name}}"
                                    data-phone-number="{{i.Phone_number}}"
                                    data-area="{{i.Area}}"
                                    data-product="{{i.Product}}"
                                    data-demand="{{i.Demand}}"
                                    data-status="{{i.Status}}"
                                    data-note="{{i.Note}}"
                                    data-belong-campaign-name="{{i.Belong_Campaign.Name}}"
                                    data-belong-campaign-id="{{i.Belong_Campaign.id}}"
                                    data-belong-user-username="{{i.Belong_User.username}}"
                                    data-belong-user-id="{{i.Belong_User.id}}"
                                        class="open_form_update flex justify-center items-center ml-2 cursor-pointer px-1 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-green-600 border border-transparent rounded-md active:bg-stone-600 hover:bg-green-700 focus:outline-none focus:shadow-outline-green">
                                        <svg class="fill-white" width="32px" height="32px" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                                            <title>icon 135 pen angled</title>
                                            <desc>Created with Sketch.</desc>
                                            <defs></defs>
                                            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage">
                                                <g id="icon-135-pen-angled" sketch:type="MSArtboardGroup" fill="#ffffff">
                                                    <path d="M23.1464466,12.0278086 L11.8535534,23.3207019 L11.8535534,23.3207019 L7.85355339,19.3207019 L19.1464466,8.02780864 L23.1464466,12.0278086 L23.1464466,12.0278086 Z M23.8535534,11.3207018 L25.5801067,9.59414849 C26.3642921,8.8099631 26.3661881,7.54044334 25.5897496,6.76400487 L24.4102504,5.58450561 C23.6313906,4.80564584 22.372781,4.80147421 21.5801067,5.59414851 L19.8535534,7.32070186 L23.8535534,11.3207018 L23.8535534,11.3207018 Z M11.1464466,24.0278086 L11,24.1742552 L6,25.1742552 L7,20.1742552 L7.14644661,20.0278086 L11.1464466,24.0278086 L11.1464466,24.0278086 Z" id="pen-angled" sketch:type="MSShapeGroup"></path>
                                                </g>
                                            </g>
                                        </svg>
                                    </a> {% endcomment %}
                                    <a title="Cập nhật báo cáo" data-id="{{i.id}}" data-name="{{i.Name}}" data-report="{{i.Report}}" class="open_form_Report flex justify-center items-center ml-2 cursor-pointer px-1 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-green-600 border border-transparent rounded-md active:bg-stone-600 hover:bg-green-700 focus:outline-none focus:shadow-outline-green">
                                        <svg class="fill-white" width="30" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M50.29 6.5H42.46V4C42.4602 3.60901 42.3076 3.23342 42.0349 2.95324C41.7622 2.67305 41.3909 2.51043 41 2.5H23.18C22.7822 2.5 22.4007 2.65804 22.1194 2.93934C21.8381 3.22064 21.68 3.60218 21.68 4V6.5H14.29C12.8322 6.50264 11.4347 7.08295 10.4039 8.11383C9.37299 9.14471 8.79268 10.5421 8.79004 12V56C8.79268 57.4579 9.37299 58.8553 10.4039 59.8862C11.4347 60.917 12.8322 61.4974 14.29 61.5H50.29C51.7479 61.4974 53.1453 60.917 54.1762 59.8862C55.2071 58.8553 55.7874 57.4579 55.79 56V12C55.7874 10.5421 55.2071 9.14471 54.1762 8.11383C53.1453 7.08295 51.7479 6.50264 50.29 6.5V6.5ZM24.68 5.5H39.46V10.5H24.68V5.5ZM52.79 56C52.79 56.663 52.5266 57.2989 52.0578 57.7678C51.589 58.2366 50.9531 58.5 50.29 58.5H14.29C13.627 58.5 12.9911 58.2366 12.5223 57.7678C12.0534 57.2989 11.79 56.663 11.79 56V12C11.79 11.337 12.0534 10.7011 12.5223 10.2322C12.9911 9.76339 13.627 9.5 14.29 9.5H21.68V12C21.68 12.3978 21.8381 12.7794 22.1194 13.0607C22.4007 13.342 22.7822 13.5 23.18 13.5H41C41.3979 13.5 41.7794 13.342 42.0607 13.0607C42.342 12.7794 42.5 12.3978 42.5 12V9.5H50.33C50.9931 9.5 51.629 9.76339 52.0978 10.2322C52.5666 10.7011 52.83 11.337 52.83 12L52.79 56Z" fill="white"></path>
                                            <path d="M44.5 19.75H19.5C19.1022 19.75 18.7206 19.908 18.4393 20.1893C18.158 20.4706 18 20.8522 18 21.25C18 21.6478 18.158 22.0294 18.4393 22.3107C18.7206 22.592 19.1022 22.75 19.5 22.75H44.5C44.8978 22.75 45.2794 22.592 45.5607 22.3107C45.842 22.0294 46 21.6478 46 21.25C46 20.8522 45.842 20.4706 45.5607 20.1893C45.2794 19.908 44.8978 19.75 44.5 19.75Z" fill="white"></path>
                                            <path d="M44.5 29.6699H19.5C19.1022 29.6699 18.7206 29.828 18.4393 30.1093C18.158 30.3906 18 30.7721 18 31.1699C18 31.5677 18.158 31.9493 18.4393 32.2306C18.7206 32.5119 19.1022 32.6699 19.5 32.6699H44.5C44.8978 32.6699 45.2794 32.5119 45.5607 32.2306C45.842 31.9493 46 31.5677 46 31.1699C46 30.7721 45.842 30.3906 45.5607 30.1093C45.2794 29.828 44.8978 29.6699 44.5 29.6699Z" fill="white"></path>
                                            <path d="M44.5 39.5801H19.5C19.1022 39.5801 18.7206 39.7381 18.4393 40.0194C18.158 40.3007 18 40.6823 18 41.0801C18 41.4779 18.158 41.8594 18.4393 42.1407C18.7206 42.422 19.1022 42.5801 19.5 42.5801H44.5C44.8978 42.5801 45.2794 42.422 45.5607 42.1407C45.842 41.8594 46 41.4779 46 41.0801C46 40.6823 45.842 40.3007 45.5607 40.0194C45.2794 39.7381 44.8978 39.5801 44.5 39.5801Z" fill="white"></path>
                                            <path d="M44.5 49.5H19.5C19.1022 49.5 18.7206 49.658 18.4393 49.9393C18.158 50.2206 18 50.6022 18 51C18 51.3978 18.158 51.7794 18.4393 52.0607C18.7206 52.342 19.1022 52.5 19.5 52.5H44.5C44.8978 52.5 45.2794 52.342 45.5607 52.0607C45.842 51.7794 46 51.3978 46 51C46 50.6022 45.842 50.2206 45.5607 49.9393C45.2794 49.658 44.8978 49.5 44.5 49.5Z" fill="white"></path>
                                            </svg>
                                    </a>
                                    {% comment %} <a title="Cập nhật ghi chú lịch sử CSKH" data-id="{{i.id}}" data-name="{{i.Name}}" data-history="{{i.History}}" class="open_form_History flex justify-center items-center ml-2 cursor-pointer px-1 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-green-600 border border-transparent rounded-md active:bg-stone-600 hover:bg-green-700 focus:outline-none focus:shadow-outline-green">
                                        <svg class="fill-white" width="33px"  viewBox="0 0 21 18" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                            <desc>Created with Sketch.</desc>
                                            <g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                                <g id="Rounded" transform="translate(-441.000000, -289.000000)">
                                                    <g id="Action" transform="translate(100.000000, 100.000000)">
                                                        <g id="-Round-/-Action-/-history" transform="translate(340.000000, 186.000000)">
                                                            <g transform="translate(0.000000, 0.000000)">
                                                                <polygon id="Path" points="0 0 24 0 24 24 0 24"></polygon>
                                                                <path d="M13.26,3 C8.17,2.86 4,6.95 4,12 L2.21,12 C1.76,12 1.54,12.54 1.86,12.85 L4.65,15.65 C4.85,15.85 5.16,15.85 5.36,15.65 L8.15,12.85 C8.46,12.54 8.24,12 7.79,12 L6,12 C6,8.1 9.18,4.95 13.1,5 C16.82,5.05 19.95,8.18 20,11.9 C20.05,15.81 16.9,19 13,19 C11.39,19 9.9,18.45 8.72,17.52 C8.32,17.21 7.76,17.24 7.4,17.6 C6.98,18.02 7.01,18.73 7.48,19.09 C9,20.29 10.91,21 13,21 C18.05,21 22.14,16.83 22,11.74 C21.87,7.05 17.95,3.13 13.26,3 Z M12.75,8 C12.34,8 12,8.34 12,8.75 L12,12.43 C12,12.78 12.19,13.11 12.49,13.29 L15.61,15.14 C15.97,15.35 16.43,15.23 16.64,14.88 C16.85,14.52 16.73,14.06 16.38,13.85 L13.5,12.14 L13.5,8.74 C13.5,8.34 13.16,8 12.75,8 Z" id="🔹Icon-Color" fill="#ffffff"></path>
                                                            </g>
                                                        </g>
                                                    </g>
                                                </g>
                                            </g>
                                        </svg>
                                    </a> {% endcomment %}
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="pagination {% if list_lead.paginator.num_pages <= 1 %}hidden{% endif %} border-t-[1px] border-stone-200 flex items-center justify-center" >
                <ul class="flex items-center justify-center">page</ul>
            </div>
            <button id="open_form_delete_check_list_lead" style="display:none;" class="p-2 rounded-md bg-red-600 font-medium text-stone-100 mt-2">Xóa danh sách khách hàng đã chọn</button>
        </div>
        <form method="POST" action="{% url 'lead_page_admin' %}" style="display:none;"
            class="form_create xxx fixed z-9999   pb-[10px] md:pt-[0px] md:pb-[0px] overflow-x-auto inset-0 bg-black bg-opacity-50 flex justify-center items-center px-[10px]">
            {% csrf_token %}
            <div
                class="relative p-4 bg-white rounded-lg shadow-md dark:bg-gray-800 w-[500px] flex flex-col gap-3 justify-center items-center">
                <h3 class="text-[18px] font-bold text-stone-800 w-full text-center">Tạo khách hàng mới</h3>
                <div class="grid grid-cols-2 gap-2 w-full">
                    <label class="block text-sm w-full col-span-2">
                        <span class="font-medium text-stone-600">Nguồn khách hàng</span>
                        <select name="Source" required
                        class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md ">
                            {% for i in Select_setting.Source %}
                            <option value="{{i}}">{{i}}</option>
                            {% endfor %}
                        </select>
                    </label>
                    <label class="block text-sm w-full">
                        <span class="font-medium text-stone-600">Tên khách hàng</span>
                        <input name="Name" required
                            class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md">
                    </label>
                    <label class="block text-sm w-full">
                        <span class="font-medium text-stone-600">Số điện thoại</span>
                        <input name="Phone_number" required 
                            class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md">
                    </label>
                    <label class="block text-sm w-full">
                        <span class="font-medium text-stone-600">Khu vực</span>
                        <select name="Area" required
                        class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md ">
                            {% for i in Select_setting.Area %}
                            <option value="{{i}}">{{i}}</option>
                            {% endfor %}
                        </select>
                    </label>
                    <label class="block text-sm w-full">
                        <span class="font-medium text-stone-600">Sản phẩm</span>
                        <select name="Product" required
                        class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md ">
                            {% for i in Select_setting.Product %}
                            <option value="{{i}}">{{i}}</option>
                            {% endfor %}
                        </select>
                    </label>
                    <label class="block text-sm w-full">
                        <span class="font-medium text-stone-600">Nhu cầu</span>
                        <select name="Demand" required
                        class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md ">
                            {% for i in Select_setting.Demand %}
                            <option value="{{i}}">{{i}}</option>
                            {% endfor %}
                        </select>
                    </label>
                    <label class="block text-sm w-full">
                        <span class="font-medium text-stone-600">Tình trạng</span>
                        <input name="Status" required value="Khách hàng mới" readonly
                            class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md ">
                    </label>
                    <label class="flex flex-col text-sm w-full h-full ">
                        <span class="font-medium text-stone-600">Ghi chú</span>
                        <textarea name="Note" required class="w-full grow block  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md "></textarea>
                    </label>
                    <label class="flex flex-col text-sm w-full h-[250px]">
                        <span class="font-medium text-stone-600">Chiến dịch</span>
                        <input type="hidden" name="Belong_Campaign" id="Belong_Campaign"
                            class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md "
                            >
                        <input id="Belong_Campaign_label"
                            class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md "
                            readonly>
                        <div class="flex flex-col grow rounded-md overflow-hidden p-2 bg-stone-300 mt-2 gap-2 h-full">
                            <div id="menu_list_campaign" class="flex flex-col gap-1 h-full overflow-y-auto">
                                <!-- Chiến dịch -->
                            </div>
                            <div class="flex  relative items-center w-full">
                                <input placeholder="Tìm kiếm Chiến dịch" name="s_campaign"
                                    class="block pr-[30px] w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md " />
                                <svg id="submit_search_campaign"  class="w-[30px] absolute right-0 cursor-pointer" viewBox="0 0 32 32" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                    xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                                    <!-- Generator: Sketch 3.0.3 (7891) - http://www.bohemiancoding.com/sketch -->
                                    <title>icon 111 search</title>
                                    <desc>Created with Sketch.</desc>
                                    <defs></defs>
                                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"
                                        sketch:type="MSPage">
                                        <g id="icon-111-search" sketch:type="MSArtboardGroup" fill="#000000">
                                            <path
                                                d="M19.4271164,21.4271164 C18.0372495,22.4174803 16.3366522,23 14.5,23 C9.80557939,23 6,19.1944206 6,14.5 C6,9.80557939 9.80557939,6 14.5,6 C19.1944206,6 23,9.80557939 23,14.5 C23,16.3366522 22.4174803,18.0372495 21.4271164,19.4271164 L27.0119176,25.0119176 C27.5621186,25.5621186 27.5575313,26.4424687 27.0117185,26.9882815 L26.9882815,27.0117185 C26.4438648,27.5561352 25.5576204,27.5576204 25.0119176,27.0119176 L19.4271164,21.4271164 L19.4271164,21.4271164 Z M14.5,21 C18.0898511,21 21,18.0898511 21,14.5 C21,10.9101489 18.0898511,8 14.5,8 C10.9101489,8 8,10.9101489 8,14.5 C8,18.0898511 10.9101489,21 14.5,21 L14.5,21 Z"
                                                id="search" sketch:type="MSShapeGroup"></path>
                                        </g>
                                    </g>
                                </svg>
                            </div>
                        </div>
                    </label>
                </div>
                <div style="display: none;" id="loader_form_create" class="absolute inset-0 flex justify-center items-center bg-black bg-opacity-50">
                    <span  class="loader"></span>
                </div>
                <div class="flex items-center gap-2">
                    <button type="submit"
                        class="px-3 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-green-600 border border-transparent rounded-md active:bg-green-600 hover:bg-green-700 focus:outline-none focus:shadow-outline-green">
                        Tạo ngay
                    </button>
                    <a
                        class=" close_form_create cursor-pointer px-3 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-stone-600 border border-transparent rounded-md active:bg-stone-600 hover:bg-stone-700 focus:outline-none focus:shadow-outline-green">
                        Hủy
                    </a>
                </div>
            </div>
            <script>
                $(document).ready(function() {
                    $('.form_create').on('submit', function(event) {
                        $('#loader_form_create').show();
                    });
                });
            </script>
            <style>
                .loader {
                    width: 80px;
                    height: 80px;
                    border: 13px dotted #22c55e;
                    border-radius: 50%;
                    display: inline-block;
                    position: relative;
                    box-sizing: border-box;
                    animation: rotation 2s linear infinite;
                }
                
                @keyframes rotation {
                    0% {
                    transform: rotate(0deg);
                    }
                    100% {
                    transform: rotate(360deg);
                    }
                }  
            </style>
        </form>
        <form method="POST" action="{% url 'lead_update_page_admin' %}" style="display:none;"
            class="form_update xxx fixed z-9999  pb-[10px] md:pt-[0px] md:pb-[0px] overflow-x-auto inset-0 bg-black bg-opacity-50 flex justify-center items-center px-[10px]">
            {% csrf_token %}
            <input type="hidden" name="id_lead_update" id="id_lead_update" />
            <div
                class="p-4 bg-white rounded-lg shadow-md dark:bg-gray-800 w-[500px] flex flex-col gap-3 justify-center items-center">
                <h3 class="text-[18px] font-bold text-stone-800 w-full text-center">Cập nhật khách hàng</h3>
                <div class="grid grid-cols-2 gap-2 w-full">
                    <label class="block text-sm w-full">
                        <span class="font-medium text-stone-600">Tên khách hàng</span>
                        <input name="Name" id="Name_update" required
                            class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md">
                    </label>
                    <label class="block text-sm w-full">
                        <span class="font-medium text-stone-600">Số điện thoại</span>
                        <input name="Phone_number" id="Phone_number_update" required 
                            class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md">
                    </label>
                    <label class="block text-sm w-full">
                        <span class="font-medium text-stone-600">Khu vực</span>
                        <select name="Area" id="Area_update" required
                        class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md ">
                            {% for i in Select_setting.Area %}
                            <option value="{{i}}">{{i}}</option>
                            {% endfor %}
                        </select>
                    </label>
                    <label class="block text-sm w-full">
                        <span class="font-medium text-stone-600">Sản phẩm</span>
                        <select name="Product" id="Product_update" required
                        class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md ">
                            {% for i in Select_setting.Product %}
                            <option value="{{i}}">{{i}}</option>
                            {% endfor %}
                        </select>
                    </label>
                    <label class="block text-sm w-full">
                        <span class="font-medium text-stone-600">Nhu cầu</span>
                        <select name="Demand" id="Demand_update"  required
                        class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md ">
                            {% for i in Select_setting.Demand %}
                            <option value="{{i}}">{{i}}</option>
                            {% endfor %}
                        </select>
                    </label>
                    <label class="block text-sm w-full">
                        <span class="font-medium text-stone-600">Tình trạng</span>
                        <input name="Status" id="Status_update" required value="Khách hàng mới" readonly
                            class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md ">
                    </label>
                    <label class="flex flex-col text-sm w-full h-full">
                        <span class="font-medium text-stone-600">Ghi chú</span>
                        <textarea name="Note" id="Note_update" required class="w-full grow block  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md "></textarea>
                    </label>
                    <label class="flex flex-col text-sm w-full h-[250px]">
                        <span class="font-medium text-stone-600">Chiến dịch</span>
                        <input type="hidden" name="Belong_Campaign" id="Belong_Campaign_update"
                            class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md "
                            >
                        <input id="Belong_Campaign_label_update"
                            class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md "
                            readonly>
                        <div class="flex flex-col grow rounded-md overflow-hidden p-2 bg-stone-300 mt-2 gap-2 h-full">
                            <div id="menu_list_campaign_update" class="flex flex-col gap-1 h-full overflow-y-auto">
                                <!-- Chiến dịch -->
                            </div>
                            <div class="flex  relative items-center w-full">
                                <input placeholder="Tìm kiếm Chiến dịch" name="s_campaign_update"
                                    class="block pr-[30px] w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md " />
                                <svg id="submit_search_campaign_update"  class="w-[30px] absolute right-0 cursor-pointer" viewBox="0 0 32 32" version="1.1"
                                    xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                    xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                                    <!-- Generator: Sketch 3.0.3 (7891) - http://www.bohemiancoding.com/sketch -->
                                    <title>icon 111 search</title>
                                    <desc>Created with Sketch.</desc>
                                    <defs></defs>
                                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"
                                        sketch:type="MSPage">
                                        <g id="icon-111-search" sketch:type="MSArtboardGroup" fill="#000000">
                                            <path
                                                d="M19.4271164,21.4271164 C18.0372495,22.4174803 16.3366522,23 14.5,23 C9.80557939,23 6,19.1944206 6,14.5 C6,9.80557939 9.80557939,6 14.5,6 C19.1944206,6 23,9.80557939 23,14.5 C23,16.3366522 22.4174803,18.0372495 21.4271164,19.4271164 L27.0119176,25.0119176 C27.5621186,25.5621186 27.5575313,26.4424687 27.0117185,26.9882815 L26.9882815,27.0117185 C26.4438648,27.5561352 25.5576204,27.5576204 25.0119176,27.0119176 L19.4271164,21.4271164 L19.4271164,21.4271164 Z M14.5,21 C18.0898511,21 21,18.0898511 21,14.5 C21,10.9101489 18.0898511,8 14.5,8 C10.9101489,8 8,10.9101489 8,14.5 C8,18.0898511 10.9101489,21 14.5,21 L14.5,21 Z"
                                                id="search" sketch:type="MSShapeGroup"></path>
                                        </g>
                                    </g>
                                </svg>
                            </div>
                        </div>
                    </label>
                </div>
                <div style="display: none;" id="loader_form_update" class="absolute inset-0 flex justify-center items-center bg-black bg-opacity-50">
                    <span  class="loader"></span>
                </div>
                <div class="flex items-center gap-2">
                    <button type="submit"
                        class="px-3 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-green-600 border border-transparent rounded-md active:bg-green-600 hover:bg-green-700 focus:outline-none focus:shadow-outline-green">
                        Cập nhật
                    </button>
                    <a
                        class=" close_form_update cursor-pointer px-3 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-stone-600 border border-transparent rounded-md active:bg-stone-600 hover:bg-stone-700 focus:outline-none focus:shadow-outline-green">
                        Hủy
                    </a>
                </div>
            </div>
            <script>
                $(document).ready(function() {
                    $('.form_update').on('submit', function(event) {
                        $('#loader_form_update').show();
                    });
                });
            </script>
        </form>
        <form id="form_delete_check_list_lead" style="display:none;" class=" xxx px-[10px] fixed z-9999 inset-0  flex justify-center items-center bg-black bg-opacity-50">
            <div id="" class="relative  flex gap-3 flex-col justify-center items-center p-4 bg-white rounded-lg shadow-md text-red-500 font-medium ">
                <input type="hidden" id="check_list" />
                <span>* Danh sách khách hàng đã chọn sẽ bị xóa *</span>
                <span class="text-stone-500">Nhập "<span class="text_code text-green-500">Tôi đồng ý xóa danh sách khách hàng đã chọn</span>" vào ô bên dưới và tiến hành xóa</span>
                <input type="text"  placeholder="" id="text_check_list"  class=" w-full rounded-md text-center bg-stone-200 text-green-500" required/>
                <div></div>
                <div class="flex items-center gap-2">
                    <button type="submit"
                        class="px-3 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-red-600 border border-transparent rounded-md active:bg-green-600 hover:bg-green-700 focus:outline-none focus:shadow-outline-green">
                        Xóa khách hàng đã chọn
                    </button>
                    <a
                        class="close_form_delete_check_list_lead cursor-pointer px-3 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-stone-600 border border-transparent rounded-md active:bg-stone-600 hover:bg-stone-700 focus:outline-none focus:shadow-outline-green">
                        Hủy
                    </a>
                </div>
            </div>
        </form>
        <form method="post" action="{% url 'lead_update_report_history_page_staff' %}" style="display:none;"
            class="form_update_report xxx fixed z-9999 inset-0 bg-black bg-opacity-50 flex justify-center items-center px-[10px]">
            {% csrf_token %}
            <input type="hidden" name="id_lead_update_report" id="id_lead_update_report" />
            <div
                class="p-4 bg-white rounded-lg shadow-md dark:bg-gray-800 w-[500px] flex flex-col gap-3 justify-center items-center">
                <h3 class="text-[18px] font-bold text-stone-800 w-full text-center">
                    Thêm <span class="underline">báo cáo</span> khách hàng
                    <br>
                    <span class="text_lead_report text-green-500">"Vũ Văn Thái"</span>
                </h3>
                <div class="grid grid-cols-1 w-full">
                    <label class="flex flex-col text-sm w-full h-[150px] col-span-2">
                        <textarea name="report_update" id="report_update" required class="w-full grow block  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md "></textarea>
                    </label>
                </div>
                <div class="flex items-center gap-2">
                    <button type="submit"
                        class="px-3 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-green-600 border border-transparent rounded-md active:bg-green-600 hover:bg-green-700 focus:outline-none focus:shadow-outline-green">
                        Thêm 
                    </button>
                    <a
                        class=" close_form_update_report cursor-pointer px-3 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-stone-600 border border-transparent rounded-md active:bg-stone-600 hover:bg-stone-700 focus:outline-none focus:shadow-outline-green">
                        Đóng
                    </a>
                </div>
            </div>
        </form>
        <form method="post" action="{% url 'lead_update_report_history_page_staff' %}" style="display:none;"
            class="form_update_history xxx fixed z-9999 inset-0 bg-black bg-opacity-50 flex justify-center items-center px-[10px]">
            {% csrf_token %}
            <input type="hidden" name="id_lead_update_history" id="id_lead_update_history" />
            <div
                class="p-4 bg-white rounded-lg shadow-md dark:bg-gray-800 w-[500px] flex flex-col gap-3 justify-center items-center">
                <h3 class="text-[18px] font-bold text-stone-800 w-full text-center">
                    Thêm <span class="underline">ghi chú lịch sử</span> khách hàng
                    <br>
                    <span class="text_lead_history text-green-500">"Vũ Văn Thái"</span>
                </h3>
                <div class="grid grid-cols-1 w-full">
                    <label class="flex flex-col text-sm w-full h-[150px] col-span-2">
                        <textarea name="history_update" id="history_update" required class="w-full grow block  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md "></textarea>
                    </label>
                </div>
                <div class="flex items-center gap-2">
                    <button type="submit"
                        class="px-3 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-green-600 border border-transparent rounded-md active:bg-green-600 hover:bg-green-700 focus:outline-none focus:shadow-outline-green">
                        Thêm 
                    </button>
                    <a
                        class=" close_form_update_history cursor-pointer px-3 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-stone-600 border border-transparent rounded-md active:bg-stone-600 hover:bg-stone-700 focus:outline-none focus:shadow-outline-green">
                        Đóng
                    </a>
                </div>
            </div>
        </form>
        <form method="POST" action="{% url 'upload_file_lead_page_admin' %}" enctype="multipart/form-data" style="display:none;"
            class="form_upload_file xxx fixed z-9999 inset-0 bg-black bg-opacity-50 flex justify-center items-center px-[10px]">
            {% csrf_token %}
            <div
                class="relative p-4 bg-white rounded-lg shadow-md dark:bg-gray-800 w-[500px] flex flex-col gap-3 justify-center items-center">
                <h3 class="text-[18px] font-bold text-stone-800 w-full text-center">Nhập file khách hàng mới (.xlsx)</h3>
                <div class="grid grid-cols-1  w-full">
                    <label class="block text-sm w-full">
                        <input name="file_upload" type="file" accept=".xlsx" required
                            class="block w-full  text-sm dark:border-gray-600 dark:bg-gray-700 focus:border-green-400 focus:outline-none focus:shadow-outline-green dark:text-gray-300 dark:focus:shadow-outline-gray form-input rounded-md">
                    </label>
                </div>
                <div style="display: none;" id="loader_form_upload_file" class="absolute inset-0 flex justify-center items-center bg-black bg-opacity-50">
                    <span  class="loader"></span>
                </div>
                <div class="flex items-center gap-2">
                    <button type="submit"
                        class="px-3 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-green-600 border border-transparent rounded-md active:bg-green-600 hover:bg-green-700 focus:outline-none focus:shadow-outline-green">
                        Tạo dữ liệu
                    </button>
                    <a
                        class=" close_form_upload_file cursor-pointer px-3 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-stone-600 border border-transparent rounded-md active:bg-stone-600 hover:bg-stone-700 focus:outline-none focus:shadow-outline-green">
                        Hủy
                    </a>
                </div>
            </div>
            <script>
                $(document).ready(function() {
                    $('.form_upload_file').on('submit', function(event) {
                        $('#loader_form_upload_file').show();
                    });

                    $('.close_form_upload_file').on('click', function(event) {
                        $('.form_upload_file').hide();
                    });
                    $('.open_form_upload_file').on('click', function(event) {
                        $(".xxx").hide();
                        $('.form_upload_file').show();
                    });
                });
            </script>
            <style>
                .loader {
                    width: 80px;
                    height: 80px;
                    border: 13px dotted #22c55e;
                    border-radius: 50%;
                    display: inline-block;
                    position: relative;
                    box-sizing: border-box;
                    animation: rotation 2s linear infinite;
                }
                
                @keyframes rotation {
                    0% {
                    transform: rotate(0deg);
                    }
                    100% {
                    transform: rotate(360deg);
                    }
                }  
            </style>
        </form>
        <div id="view_report" style="display:none;"
            class="view_report xxx fixed z-9999 inset-0 bg-black bg-opacity-50 flex justify-center items-center px-[10px]">
            {% csrf_token %}
            <div
                class="relative p-4 bg-white rounded-lg shadow-md dark:bg-gray-800 w-[500px] flex flex-col gap-3 justify-center items-center h-[600px]">
                <h3 class="text-[18px] font-bold text-stone-800 w-full text-center">
                    Danh sách báo cáo khách hàng
                    <br>
                    <span id="name_lead_report" class="text-green-500"></span>
                </h3>
                <div id="text_html_report" class="flex flex-col  w-full bg-stone-200 rounded-md p-2 grow overflow-y-auto overflow-x-auto">
                </div>
                <div style="display: none;" id="loader_form_upload_file" class="absolute inset-0 flex justify-center items-center bg-black bg-opacity-50">
                    <span  class="loader"></span>
                </div>
                <div class="flex items-center gap-2">
                    <a
                        class=" close_view_report cursor-pointer px-3 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-stone-600 border border-transparent rounded-md active:bg-stone-600 hover:bg-stone-700 focus:outline-none focus:shadow-outline-green">
                        Đóng
                    </a>
                </div>
            </div>
            <script>
                $(document).ready(function() {
                    $('.close_view_report').on('click', function(event) {
                        $('.view_report').hide();
                    });
                    $('.open_view_report').on('click', function(event) {
                        $(".xxx").hide();
                        $.ajax({
                            url: '{% url "get_list_report_history" %}',  // URL của API bạn muốn gọi
                            method: 'GET',
                            data: {
                                'type_get':'Report',
                                'id_lead_report_history': $(this).data('id'),  // Gửi dữ liệu tìm kiếm với key là 's'
                                'csrfmiddlewaretoken': '{{ csrf_token }}'  // Đảm bảo CSRF token có trong request
                            },
                            success: function(response) {
                                if (response.success) {
                                    let reportHtml = '';  // Biến để lưu HTML của báo cáo
                                    // Lặp qua các dữ liệu trả về (giả sử response.data chứa các đối tượng cần hiển thị)
                                    response.data.forEach(function(item, index) {
                                        // Chuyển đổi Creation_time thành định dạng mong muốn (ví dụ: ngày-tháng-năm giờ:phút)
                                        let reportNumber = index + 1;
                                        let formattedReport = item.report.replace(/\n/g, '<br>');  // Thay \n bằng <br>
                                        // Tạo HTML cho mỗi báo cáo
                                        reportHtml += `
                                            <div class="flex flex-col gap-1 text-sm w-full">
                                                <span>${reportNumber} ------------------------------------------------ ${item.Creation_time}</span>
                                                <span>${formattedReport}</span>
                                            </div>
                                            <br>
                                        `;
                                    });
                                    $('#text_html_report').html('');
                                    // Chèn HTML vào trong phần tử #text_html_report
                                    $('#text_html_report').append(reportHtml);

                                } else {
                                    console.log('Không tìm thấy chiến dịch nào');
                                }
                            },
                            error: function (response) {
                                console.log('Tìm kiếm thất bại', response);
                            }
                        });
                        $('#name_lead_report').text($(this).data('name'));
                        $('.view_report').show();
                    });
                });
            </script>
        </div>
        <div id="view_history" style="display:none;"
            class="view_history xxx fixed z-9999 inset-0 bg-black bg-opacity-50 flex justify-center items-center px-[10px]">
            {% csrf_token %}
            <div
                class="relative p-4 bg-white rounded-lg shadow-md dark:bg-gray-800 w-[500px] flex flex-col gap-3 justify-center items-center h-[600px]">
                <h3 class="text-[18px] font-bold text-stone-800 w-full text-center">
                    Danh sách ghi chú lịch sử khách hàng
                    <br>
                    <span id="name_lead_history" class="text-green-500"></span>
                </h3>
                <div id="text_html_history" class="flex flex-col  w-full bg-stone-200 rounded-md p-2 grow overflow-y-auto overflow-x-auto">
                </div>
                <div style="display: none;" id="loader_form_upload_file" class="absolute inset-0 flex justify-center items-center bg-black bg-opacity-50">
                    <span  class="loader"></span>
                </div>
                <div class="flex items-center gap-2">
                    <a
                        class=" close_view_history cursor-pointer px-3 py-1 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-stone-600 border border-transparent rounded-md active:bg-stone-600 hover:bg-stone-700 focus:outline-none focus:shadow-outline-green">
                        Đóng
                    </a>
                </div>
            </div>
            <script>
                $(document).ready(function() {
                    $('.close_view_history').on('click', function(event) {
                        $('.view_history').hide();
                    });
                    $('.open_view_history').on('click', function(event) {
                        $(".xxx").hide();
                        $.ajax({
                            url: '{% url "get_list_report_history" %}',  // URL của API bạn muốn gọi
                            method: 'GET',
                            data: {
                                'type_get':'History',
                                'id_lead_report_history': $(this).data('id'),  // Gửi dữ liệu tìm kiếm với key là 's'
                                'csrfmiddlewaretoken': '{{ csrf_token }}'  // Đảm bảo CSRF token có trong request
                            },
                            success: function(response) {
                                if (response.success) {
                                    let reportHtml = '';  // Biến để lưu HTML của báo cáo
                                    // Lặp qua các dữ liệu trả về (giả sử response.data chứa các đối tượng cần hiển thị)
                                    response.data.forEach(function(item, index) {
                                        // Chuyển đổi Creation_time thành định dạng mong muốn (ví dụ: ngày-tháng-năm giờ:phút)
                                        let reportNumber = index + 1;
                                        let formattedReport = item.history.replace(/\n/g, '<br>');  // Thay \n bằng <br>
                                        // Tạo HTML cho mỗi báo cáo
                                        reportHtml += `
                                            <div class="flex flex-col gap-1 text-sm w-full">
                                                <span>${reportNumber} ------------------------------------------------ ${item.Creation_time}</span>
                                                <span>${formattedReport}</span>
                                            </div>
                                            <br>
                                        `;
                                    });
                                    $('#text_html_history').html('');
                                    // Chèn HTML vào trong phần tử #text_html_report
                                    $('#text_html_history').append(reportHtml);

                                } else {
                                    console.log('Không tìm thấy chiến dịch nào');
                                }
                            },
                            error: function (response) {
                                console.log('Tìm kiếm thất bại', response);
                            }
                        });
                        $('#name_lead_history').text($(this).data('name'));
                        $('.view_history').show();
                    });
                });
            </script>
        </div>
        {% else %}
        <h1 class="text-[18px] font-bold text-yellow-500">Tài khoản cảu bạn đang chờ phê duyệt !</h1>
        {% endif %}
    </main>
</div>
<script>
    $(document).ready(function() {
        function updateTableWidth() {
          var containerWidth = $('#table-container').parent().width(); // Lấy chiều rộng của phần tử cha
          var tableWidth = $('#table-container').outerWidth(); // Lấy chiều rộng của bảng
      
          // Kiểm tra nếu bảng rộng hơn chiều rộng container, thì mới trừ 250px
          if (tableWidth > containerWidth) {
            $('#table-container').width(containerWidth - 250); // Trừ đi 250px
          } else {
            $('#table-container').width(''); // Đặt lại chiều rộng mặc định
          }
        }
      
        // Gọi hàm khi trang được tải và khi cửa sổ thay đổi kích thước
        updateTableWidth();
        $(window).resize(function() {
          updateTableWidth();
        });
      });      
</script>
<script>
    $(document).ready(function () {
        $(".open_form_Report").click(function () {
            $(".xxx").hide();
            $(".form_update_report").show();
            $("#id_lead_update_report").val($(this).data('id'));
            $("#report_update").val($(this).data('report'));
            $(".text_lead_report").text($(this).data('name'));
        });
        $(".close_form_update_report").click(function () {
            $(".form_update_report").hide();
        });

        $(".open_form_History").click(function () {
            $(".xxx").hide();
            $(".form_update_history").show();
            $("#id_lead_update_history").val($(this).data('id'));
            $("#history_update").val($(this).data('history'));
            $(".text_lead_history").text($(this).data('name'));
        });
        $(".close_form_update_history").click(function () {
            $(".form_update_history").hide();
        });
    });
</script>
<script>
    $(document).on('click', '.import_campaign', function () {
        $("#Belong_Campaign_label").val($(this).data('campaign-name'));
        $("#Belong_Campaign").val($(this).data('campaign-id'));
    });
</script>
<script>
    $(document).on('click', '.import_user', function () {
        $("#Belong_User_label").val($(this).data('user-name'));
        $("#Belong_User").val($(this).data('user-id'));
    });
</script>
<script>
    $(document).on('click', '.import_campaign_update', function () {
        $("#Belong_Campaign_label_update").val($(this).data('campaign-name'));
        $("#Belong_Campaign_update").val($(this).data('campaign-id'));
    });
</script>
<script>
    $(document).on('click', '.import_user_update', function () {
        $("#Belong_User_label_update").val($(this).data('user-name'));
        $("#Belong_User_update").val($(this).data('user-id'));
    });
</script>
<script>
    $(document).ready(function () {
        $(".open_form_create").click(function () {
            $(".xxx").hide();
            $(".form_create").show();
            $.ajax({
                url: '{% url "search_campaign_page_admin" %}',  // URL của API bạn muốn gọi
                method: 'POST',
                data: {
                    's':'',  // Gửi dữ liệu tìm kiếm với key là 's'
                    'csrfmiddlewaretoken': '{{ csrf_token }}'  // Đảm bảo CSRF token có trong request
                },
                success: function(response) {
                    if (response.success) {
                        $('#menu_list_campaign').empty();  // Dọn sạch danh sách trước khi thêm mới
                        for (let i = 0; i < response.list_campaign.length; i++) {
                            const campaign = response.list_campaign[i];
                            $('#menu_list_campaign').append(`
                                <span data-campaign-name="${campaign.Name}" data-campaign-id="${campaign.id}" class="import_campaign cursor-pointer hover:text-green-700">
                                    ${campaign.Name}
                                </span>
                            `);
                        }
                    } else {
                        console.log('Không tìm thấy chiến dịch nào');
                    }
                },
                error: function (response) {
                    console.log('Tìm kiếm thất bại', response);
                }
            });
            $.ajax({
                url: '{% url "search_user_page_admin" %}',  // URL của API bạn muốn gọi
                method: 'POST',
                data: {
                    's':'',  // Gửi dữ liệu tìm kiếm với key là 's'
                    'csrfmiddlewaretoken': '{{ csrf_token }}'  // Đảm bảo CSRF token có trong request
                },
                success: function(response) {
                    if (response.success) {
                        $('#menu_list_user').empty();  // Dọn sạch danh sách trước khi thêm mới
                        for (let i = 0; i < response.list_user.length; i++) {
                            const user = response.list_user[i];
                            $('#menu_list_user').append(`
                                <span data-user-name="${user.username}" data-user-id="${user.id}" class="import_user cursor-pointer hover:text-green-700">
                                    ${user.username}
                                </span>
                            `);
                        }
                    } else {
                        console.log('Không tìm thấy nhân viên nào');
                    }
                },
                error: function (response) {
                    console.log('Tìm kiếm thất bại', response);
                }
            });
        });
        $(".close_form_create").click(function () {
            $(".form_create").hide();
        });

        $('#open_form_delete_check_list_lead').click(function(){
            $(".xxx").hide();
            $('#form_delete_check_list_lead').show();
        });
        $('.close_form_delete_check_list_lead').click(function(){
            $('#form_delete_check_list_lead').hide();
        });
    });
</script>
<script>
    $(document).ready(function () {
        $(".open_form_update").click(function () {
            $(".xxx").hide();
            $(".form_update").show();

            $("#id_lead_update").val($(this).data('id'));
            $("#Name_update").val($(this).data('name'));
            $("#Phone_number_update").val($(this).data('phone-number'));
            $("#Area_update").val($(this).data('area'));
            $("#Product_update").val($(this).data('product'));
            $("#Demand_update").val($(this).data('demand'));
            $("#Status_update").val($(this).data('status'));
            $("#Note_update").val($(this).data('note'));
            $("#Belong_Campaign_label_update").val($(this).data('belong-campaign-name'));
            $("#Belong_Campaign_update").val($(this).data('belong-campaign-id'));
            $("#Belong_User_label_update").val($(this).data('belong-user-username'));
            $("#Belong_User_update").val($(this).data('belong-user-id'));

            $.ajax({
                url: '{% url "search_campaign_page_admin" %}',  // URL của API bạn muốn gọi
                method: 'POST',
                data: {
                    's':'',  // Gửi dữ liệu tìm kiếm với key là 's'
                    'csrfmiddlewaretoken': '{{ csrf_token }}'  // Đảm bảo CSRF token có trong request
                },
                success: function(response) {
                    if (response.success) {
                        $('#menu_list_campaign_update').empty();  // Dọn sạch danh sách trước khi thêm mới
                        for (let i = 0; i < response.list_campaign.length; i++) {
                            const campaign = response.list_campaign[i];
                            $('#menu_list_campaign_update').append(`
                                <span data-campaign-name="${campaign.Name}" data-campaign-id="${campaign.id}" class="import_campaign_update cursor-pointer hover:text-green-700">
                                    ${campaign.Name}
                                </span>
                            `);
                        }
                    } else {
                        console.log('Không tìm thấy chiến dịch nào');
                    }
                },
                error: function (response) {
                    console.log('Tìm kiếm thất bại', response);
                }
            });

            $.ajax({
                url: '{% url "search_user_page_admin" %}',  // URL của API bạn muốn gọi
                method: 'POST',
                data: {
                    's':'',  // Gửi dữ liệu tìm kiếm với key là 's'
                    'csrfmiddlewaretoken': '{{ csrf_token }}'  // Đảm bảo CSRF token có trong request
                },
                success: function(response) {
                    if (response.success) {
                        $('#menu_list_user_update').empty();  // Dọn sạch danh sách trước khi thêm mới
                        for (let i = 0; i < response.list_user.length; i++) {
                            const user = response.list_user[i];
                            $('#menu_list_user_update').append(`
                                <span data-user-name="${user.username}" data-user-id="${user.id}" class="import_user_update cursor-pointer hover:text-green-700">
                                    ${user.username}
                                </span>
                            `);
                        }
                    } else {
                        console.log('Không tìm thấy nhân viên nào');
                    }
                },
                error: function (response) {
                    console.log('Tìm kiếm thất bại', response);
                }
            });
        });

        $(".close_form_update").click(function () {
            $(".form_update").hide();
        });
    });
</script>
<script>
    $(document).ready(function () {
        $(".open_form_delete").click(function () {
            $(".xxx").hide();
            $(".form_delete").show();
            $("#id_delete").val($(this).data('id'));
            $("#text_delete").text($(this).data('name'));
        });

        $(".close_form_delete").click(function () {
            $(".form_delete").hide();
        });
    });
</script>
<script>
    $(document).ready(function () {
        // Khi nhấn nút SVG (nút tìm kiếm)
        $('#submit_search_campaign').on('click', function (event) {
            event.preventDefault();  // Ngừng hành động mặc định của nút
            // Sử dụng serialize() để lấy dữ liệu từ form
            var searchQuery_campaign = $('input[name="s_campaign"]').val();
            $.ajax({
                url: '{% url "search_campaign_page_admin" %}',  // URL của API bạn muốn gọi
                method: 'POST',
                data: {
                    's': searchQuery_campaign,  // Gửi dữ liệu tìm kiếm với key là 's'
                    'csrfmiddlewaretoken': '{{ csrf_token }}'  // Đảm bảo CSRF token có trong request
                },
                success: function(response) {
                    if (response.success) {
                        $('#menu_list_campaign').empty();  // Dọn sạch danh sách trước khi thêm mới
                        for (let i = 0; i < response.list_campaign.length; i++) {
                            const campaign = response.list_campaign[i];
                            $('#menu_list_campaign').append(`
                                <span data-campaign-name="${campaign.Name}" data-campaign-id="${campaign.id}" class="import_campaign cursor-pointer hover:text-green-700">
                                    ${campaign.Name}
                                </span>
                            `);
                        }
                    } else {
                        console.log('Không tìm thấy chiến dịch nào');
                    }
                },
                error: function (response) {
                    console.log('Tìm kiếm thất bại', response);
                }
            });
        });

        $('#submit_search_user').on('click', function (event) {
            event.preventDefault();  // Ngừng hành động mặc định của nút
            // Sử dụng serialize() để lấy dữ liệu từ form
            var searchQuery_user = $('input[name="s_user"]').val();
            $.ajax({
                url: '{% url "search_user_page_admin" %}',  // URL của API bạn muốn gọi
                method: 'POST',
                data: {
                    's':searchQuery_user,  // Gửi dữ liệu tìm kiếm với key là 's'
                    'csrfmiddlewaretoken': '{{ csrf_token }}'  // Đảm bảo CSRF token có trong request
                },
                success: function(response) {
                    if (response.success) {
                        $('#menu_list_user').empty();  // Dọn sạch danh sách trước khi thêm mới
                        for (let i = 0; i < response.list_user.length; i++) {
                            const user = response.list_user[i];
                            $('#menu_list_user').append(`
                                <span data-user-name="${user.username}" data-user-id="${user.id}" class="import_user cursor-pointer hover:text-green-700">
                                    ${user.username}
                                </span>
                            `);
                        }
                    } else {
                        console.log('Không tìm thấy nhân viên nào');
                    }
                },
                error: function (response) {
                    console.log('Tìm kiếm thất bại', response);
                }
            });
        });
    });
</script>
<script>
    $(document).ready(function () {
        // Khi nhấn nút SVG (nút tìm kiếm)
        $('#submit_search_campaign_update').on('click', function (event) {
            event.preventDefault();  // Ngừng hành động mặc định của nút
            // Sử dụng serialize() để lấy dữ liệu từ form
            var searchQuery_campaign_update = $('input[name="s_campaign_update"]').val();
            $.ajax({
                url: '{% url "search_campaign_page_admin" %}',  // URL của API bạn muốn gọi
                method: 'POST',
                data: {
                    's': searchQuery_campaign_update,  // Gửi dữ liệu tìm kiếm với key là 's'
                    'csrfmiddlewaretoken': '{{ csrf_token }}'  // Đảm bảo CSRF token có trong request
                },
                success: function(response) {
                    if (response.success) {
                        $('#menu_list_campaign_update').empty();  // Dọn sạch danh sách trước khi thêm mới
                        for (let i = 0; i < response.list_campaign.length; i++) {
                            const campaign = response.list_campaign[i];
                            $('#menu_list_campaign_update').append(`
                                <span data-campaign-name="${campaign.Name}" data-campaign-id="${campaign.id}" class="import_campaign_update cursor-pointer hover:text-green-700">
                                    ${campaign.Name}
                                </span>
                            `);
                        }
                    } else {
                        console.log('Không tìm thấy chiến dịch nào');
                    }
                },
                error: function (response) {
                    console.log('Tìm kiếm thất bại', response);
                }
            });
        });

        $('#submit_search_user_update').on('click', function (event) {
            event.preventDefault();  // Ngừng hành động mặc định của nút
            // Sử dụng serialize() để lấy dữ liệu từ form
            var searchQuery_user_update = $('input[name="s_user_update"]').val();
            $.ajax({
                url: '{% url "search_user_page_admin" %}',  // URL của API bạn muốn gọi
                method: 'POST',
                data: {
                    's':searchQuery_user_update,  // Gửi dữ liệu tìm kiếm với key là 's'
                    'csrfmiddlewaretoken': '{{ csrf_token }}'  // Đảm bảo CSRF token có trong request
                },
                success: function(response) {
                    if (response.success) {
                        $('#menu_list_user_update').empty();  // Dọn sạch danh sách trước khi thêm mới
                        for (let i = 0; i < response.list_user.length; i++) {
                            const user = response.list_user[i];
                            $('#menu_list_user_update').append(`
                                <span data-user-name="${user.username}" data-user-id="${user.id}" class="import_user_update cursor-pointer hover:text-green-700">
                                    ${user.username}
                                </span>
                            `);
                        }
                    } else {
                        console.log('Không tìm thấy nhân viên nào');
                    }
                },
                error: function (response) {
                    console.log('Tìm kiếm thất bại', response);
                }
            });
        });
    });
</script>
<script>
    // JavaScript/jQuery
    $(document).ready(function() {
        // Khi checkbox 'check_all_user' thay đổi trạng thái
        $('#check_all_lead').on('change', function() {
            var isChecked = $(this).is(':checked');
            
            // Cập nhật trạng thái của tất cả các checkbox 'check_lead'
            $('.check_lead').prop('checked', isChecked);

            // Rà soát tất cả các checkbox 'check_lead' được chọn và lưu giá trị vào input hidden
            updateCheckedValues();
        });

        // Khi bất kỳ checkbox 'check_lead' thay đổi trạng thái
        $('.check_lead').on('change', function() {
            // Kiểm tra trạng thái của checkbox 'check_all_lead'
            var allChecked = $('.check_lead').length === $('.check_lead:checked').length;
            $('#check_all_lead').prop('checked', allChecked);

            // Rà soát tất cả các checkbox 'check_lead' được chọn và lưu giá trị vào input hidden
            updateCheckedValues();
        });

        function updateCheckedValues() {
            var checkedValues = [];
            $('.check_lead:checked').each(function() {
                checkedValues.push($(this).val());
            });
            $('#check_list').val(JSON.stringify(checkedValues)); // Gán mảng giá trị vào input hidden
            if (checkedValues.length > 0) {
                $('#open_form_delete_check_list_lead').show();
            } else {
                $('#open_form_delete_check_list_lead').hide();
            }
        }
    });
</script>
<script>
    $(document).ready(function () {
        $('#form_delete_check_list_lead').on('submit', function (event) {
            event.preventDefault();
            $.ajax({
                url: '{% url 'delete_check_list_lead_admin' %}',
                method: 'POST',
                headers: {
                    'X-CSRFToken': '{{ csrf_token }}'
                },
                contentType: 'application/json',
                data: JSON.stringify({
                    check_list: $('#check_list').val(),
                    text_check_list: $('#text_check_list').val()
                }),
                success: function (response) {
                    if (response.success) {
                        window.location.href = response.redirect_url;
                    } else {
                        alert(response.message);
                    }
                },
                error: function (response) {
                    console.log('Xóa thất bại', response);
                }
            });
        });
    });
</script>
<script>
    // selecting required element
    const element = document.querySelector(".pagination ul");
    let totalPages = {{list_lead.paginator.num_pages}};
    let page = {{list_lead.number}};
    let s_l = "{{ s|default:'' }}";  // Nếu s không có giá trị, dùng giá trị mặc định là ''
    let f_l = "{{ f|default:'' }}";  // Nếu f không có giá trị, dùng giá trị mặc định là ''
    let st_l = "{{ st|default:'' }}";  // Nếu st không có giá trị, dùng giá trị mặc định là ''

    //calling function with passing parameters and adding inside element which is ul tag
    element.innerHTML = createPagination(totalPages, page);
    function createPagination(totalPages, page) {
        let liTag = '';
        let active;
        let beforePage = page - 1;
        let afterPage = page + 1;

        // Hiển thị nút "Trang trước" nếu không phải là trang đầu tiên
        if (page > 1) {
            liTag += `<a href="?p=${page - 1}&s=${s_l}&f=${f_l}&st=${st_l}" class="btn prev"><span><i class="fas fa-angle-left"></i>Trang trước</span></a>`;
        }

        // Nếu tổng số trang nhỏ hơn 8, hiển thị tất cả các trang mà không cần dấu ba chấm
        if (totalPages < 8) {
            for (let i = 1; i <= totalPages; i++) {
                active = (page == i) ? "active" : "";
                liTag += `<a href="?p=${i}&s=${s_l}&f=${f_l}&st=${st_l}" class="numb ${active}"><span>${i}</span></a>`;
            }
        } else {
            // Nếu tổng số trang >= 8, hiển thị có điều kiện các trang với dấu ba chấm
            if (page > 2) {
                liTag += `<a href="?p=1&s=${s_l}&f=${f_l}&st=${st_l}" class="first numb"><span>1</span></a>`;
                if (page > 3) {
                    liTag += `<a class="dots"><span>...</span></a>`;
                }
            }

            // Điều chỉnh trước và sau trang hiện tại
            if (page == totalPages) {
                beforePage = beforePage - 2;
            } else if (page == totalPages - 1) {
                beforePage = beforePage - 1;
            }
            if (page == 1) {
                afterPage = afterPage + 2;
            } else if (page == 2) {
                afterPage = afterPage + 1;
            }

            // Hiển thị các trang trong khoảng trước và sau trang hiện tại
            for (let plength = beforePage; plength <= afterPage; plength++) {
                if (plength > totalPages) continue;
                if (plength == 0) plength = 1;
                active = (page == plength) ? "active" : "";
                liTag += `<a href="?p=${plength}&s=${s_l}&f=${f_l}&st=${st_l}" class="numb ${active}"><span>${plength}</span></a>`;
            }

            // Hiển thị trang cuối cùng với dấu ba chấm nếu cần
            if (page < totalPages - 1) {
                if (page < totalPages - 2) {
                    liTag += `<a class="dots"><span>...</span></a>`;
                }
                liTag += `<a href="?p=${totalPages}&s=${s_l}&f=${f_l}&st=${st_l}" class="last numb"><span>${totalPages}</span></a>`;
            }
        }

        // Hiển thị nút "Trang sau" nếu không phải là trang cuối cùng
        if (page < totalPages) {
            liTag += `<a href="?p=${page + 1}&s=${s_l}&f=${f_l}&st=${st_l}" class="btn next"><span>Trang sau <i class="fas fa-angle-right"></i></span></a>`;
        }

        element.innerHTML = liTag;
        return liTag;
    }
</script>
{% endblock %}